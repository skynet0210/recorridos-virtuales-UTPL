<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta charset="utf-8" />
    <title>Recorrido UTPL 360</title>
    <meta name="description" content="WebVR - Aframe - VR walkthrough" />
    <meta name="author" content="Kumar Ahir - VR Designer" />
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.5.1/dist/aframe-look-at-component.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto%7CRoboto+Mono" media="all" /></head>

  <body class="a-body ">
    <a-scene background="color: #ECECEC" class="fullscreen" inspector="" keyboard-shortcuts="" screenshot="" vr-mode-ui="">
    <canvas class="a-canvas" data-aframe-canvas="true" width="500" height="187"></canvas>
      <a-assets>
        <img id="point1" src="assets/1.jpg" crossorigin="anonymous">
        <img id="point2" src="assets/2.jpg" crossorigin="anonymous">
        <img id="point3" src="assets/3.jpg" crossorigin="anonymous">
        <img id="point4" src="assets/4.jpg" crossorigin="anonymous">
        <img id="point5" src="assets/5.jpg" crossorigin="anonymous">
        <img id="point6" src="assets/6.jpg" crossorigin="anonymous">
        <img id="point7" src="assets/7.jpg" crossorigin="anonymous">
        <img id="point8" src="assets/8.jpg" crossorigin="anonymous">
        <img id="point9" src="assets/9.jpg" crossorigin="anonymous">
        <img id="point10" src="assets/10.jpg" crossorigin="anonymous">
        <img id="point11" src="assets/11.jpg" crossorigin="anonymous">
        <img id="point12" src="assets/12.jpg" crossorigin="anonymous">
        <img id="hotspot" src="https://cdn.glitch.com/2087dfa6-bd02-4451-a189-36095a66f386%2Fup-arrow.png?1545397127546">
      </a-assets>

      <a-sky id="skybox" src="#point1" material="" geometry=""></a-sky>

      <a-entity id="spots" hotspots="">
        <a-entity id="group-point1">
          <a-image spot="linkto:#point2;spotgroup:group-point2" position="-8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point2" scale="0 0 0">
          <a-image spot="linkto:#point1;spotgroup:group-point1" position="8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point3;spotgroup:group-point3" position="-12 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point3" scale="0 0 0">
          <a-image spot="linkto:#point2;spotgroup:group-point2" position="8 0 -4" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point4;spotgroup:group-point4" position="-8 0 6" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point4" scale="0 0 0">
          <a-image spot="linkto:#point3;spotgroup:group-point3" position="8 0 -0.8" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point5;spotgroup:group-point5" position="-8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point5" scale="0 0 0">
          <a-image spot="linkto:#point4;spotgroup:group-point4" position="8 0 -0.5" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point6;spotgroup:group-point6" position="-8 0 -0.8" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point6" scale="0 0 0">
          <a-image spot="linkto:#point5;spotgroup:group-point5" position="12 0 0.8" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point7;spotgroup:group-point7" position="-8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point7" scale="0 0 0">
          <a-image spot="linkto:#point6;spotgroup:group-point6" position="12 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point8;spotgroup:group-point8" position="-8 0 -0.8" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point8" scale="0 0 0">
          <a-image spot="linkto:#point7;spotgroup:group-point7" position="12 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point9;spotgroup:group-point9" position="-8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point9" scale="0 0 0">
          <a-image spot="linkto:#point10;spotgroup:group-point10" position="8 0 2" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point8;spotgroup:group-point8" position="-12 0 -0.5" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point10" scale="0 0 0">
          <a-image spot="linkto:#point9;spotgroup:group-point9" position="8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point11;spotgroup:group-point11" position="-8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point11" scale="0 0 0">
          <a-image spot="linkto:#point10;spotgroup:group-point10" position="8 0 2" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
          <a-image spot="linkto:#point12;spotgroup:group-point12" position="-8 0 -5" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>

        <a-entity id="group-point12" scale="0 0 0">
          <a-image spot="linkto:#point11;spotgroup:group-point11" position="8 0 0" material="" geometry="" src="#hotspot" look-at="#cam"></a-image>
        </a-entity>



      </a-entity>

      <a-entity id="cam" camera="" position="0 1.6 0" look-controls="" rotation="-0.2291831180523293 -0.2291831180523293 0" data-aframe-inspector-original-camera="">
        <a-entity cursor="fuse:true;fuseTimeout:800" geometry="primitive:ring;radiusInner:0.01;radiusOuter:0.02" position="0 0 -1.8" material="shader:flat;color:#ff0000" animation__mouseenter="dir:reverse;dur:2000;loop:1;property:scale;startEvents:mouseenter;to:3 3 3" raycaster="">
        </a-entity>
      </a-entity>

    </a-scene>

    <script>
      AFRAME.registerComponent('hotspots',{
        init:function(){
            this.el.addEventListener('reloadspots',function(evt){

            //get the entire current spot group and scale it to 0
            var currspotgroup=document.getElementById(evt.detail.currspots);
            currspotgroup.setAttribute("scale","0 0 0");

            //get the entire new spot group and scale it to 1
            var newspotgroup=document.getElementById(evt.detail.newspots);
            newspotgroup.setAttribute("scale","1 1 1");
          });
        }
      });
      AFRAME.registerComponent('spot',{
        schema:{
          linkto:{type:"string",default:""},
          spotgroup:{type:"string",default:""}
        },
        init:function(){

          //add image source of hotspot icon
          this.el.setAttribute("src","#hotspot");
          //make the icon look at the camera all the time
          this.el.setAttribute("look-at","#cam");

          var data=this.data;

          this.el.addEventListener('click',function(){
            //set the skybox source to the new image as per the spot
            var sky=document.getElementById("skybox");
            sky.setAttribute("src",data.linkto);

            var spotcomp=document.getElementById("spots");
            var currspots=this.parentElement.getAttribute("id");
            //create event for spots component to change the spots data
            spotcomp.emit('reloadspots',{newspots:data.spotgroup,currspots:currspots});
          });
        }
      });
    </script>

</body>
</html>
